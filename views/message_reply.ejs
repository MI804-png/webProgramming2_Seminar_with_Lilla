<div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-10">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="fas fa-reply"></i> Reply to Message</h4>
                    </div>
                    <div class="card-body">
                        <% if (locals.error) { %>
                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                            <i class="fas fa-exclamation-triangle"></i> <%= error %>
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                        <% } %>

                        <!-- Original Message -->
                        <div class="card mb-4 bg-light">
                            <div class="card-header">
                                <strong>Original Message</strong>
                            </div>
                            <div class="card-body">
                                <p class="mb-2"><strong>From:</strong> <%= message.name %> &lt;<%= message.email %>&gt;</p>
                                <p class="mb-2"><strong>Received:</strong> <%= new Date(message.created_at).toLocaleString() %></p>
                                <p class="mb-2"><strong>Subject:</strong> <%= message.subject %></p>
                                <hr>
                                <p class="mb-0" style="white-space: pre-wrap;"><%= message.message %></p>
                            </div>
                        </div>

                        <!-- Reply Form -->
                        <form method="POST" action="<%= basePath %>/messages/<%= message.id %>/reply">
                            <div class="mb-3">
                                <label for="reply_subject" class="form-label fw-bold">Subject:</label>
                                <input type="text" class="form-control" id="reply_subject" name="reply_subject" 
                                       value="Re: <%= message.subject %>" required>
                            </div>

                            <div class="mb-3">
                                <label for="reply_message" class="form-label fw-bold">Your Reply:</label>
                                <textarea class="form-control" id="reply_message" name="reply_message" rows="10" 
                                          placeholder="Write your reply here..." required></textarea>
                            </div>

                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="mark_replied" name="mark_replied" checked>
                                <label class="form-check-label" for="mark_replied">
                                    Mark message as "Replied" after sending
                                </label>
                            </div>

                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i> 
                                <strong>Note:</strong> This is a demonstration reply form. In a production environment, 
                                this would send an email to <strong><%= message.email %></strong> using an email service provider.
                            </div>

                            <div class="d-flex justify-content-between">
                                <a href="<%= basePath %>/messages" class="btn btn-secondary">
                                    <i class="fas fa-arrow-left"></i> Back to Messages
                                </a>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i> Send Reply
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
